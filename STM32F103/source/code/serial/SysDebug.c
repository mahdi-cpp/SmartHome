//******************************************************************************
// 文件名称 : SysDebug.c
// 模块功能 : 系统调试堆栈维护模块.用于查找一些莫名其妙会死机的情况.
// 创建日期 : 2009-7-20
// 创建人   : wlh
// 版本     : V1.0
//******************************************************************************
//.............................FILE INCLUDE.....................................
#include "IncFile.h"

#if (SYS_OUTPUT_DEBUG)
//..............................DECLARATOR......................................
////////////////////////////////////////////////////////////////////////////////
// EXTERN DECLARATOR
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// PUBLIC DECLARATOR
////////////////////////////////////////////////////////////////////////////////
//记录系统的调试日志.
DEBUG_INFO Debug_Info[SYS_DEBUG_STACK_SIZE];
//调试信息入队序号.


////////////////////////////////////////////////////////////////////////////////
// PRIVATE DECLARATOR
////////////////////////////////////////////////////////////////////////////////

//..............................IMPLEMENT.......................................

/*******************************************************************************
 * 函数名  : Debug_In
 * 描  述  : 调试信息入队.
 * 输  入  : DEBUG_INFO * pDeubgInfo : 需要入队的调试信息.
 * 返回值  : None.
 *******************************************************************************/
void Debug_In(uchar * pInfo,uchar len)
{
	uchar i;
	static uint Debug_Index = 0x00,Stack_Index = 0x00;

	Debug_Info[Stack_Index].Index = Debug_Index++;
	for( i = 0; i < len && i < 10; i++)
	Debug_Info[Stack_Index].Name[i] = pInfo[i];
	Debug_Info[Stack_Index].Name[i] = 0x00;
	Stack_Index = (Stack_Index + 1) % SYS_DEBUG_STACK_SIZE;
	/****************************************************************************
	 下面可以添加任何想捕捉错误的代码.
	 ****************************************************************************/

}

#endif

